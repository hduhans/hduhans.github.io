/*@version:2.1 @author:zhangbo @email:freeeob@gmail.com GPL2.1*/function Animation(){this.jsjava_class="jsorg.eob.animation.Animation";this.scenes=new ArrayList();};Animation.prototype.addScene=function(scene){this.scenes.add(scene);};Animation.prototype.getScenes=function(){return this.scenes.toArray();};Animation.prototype.getScene=function(index){return this.scenes.get(index);};Animation.prototype.getMaxSceneNumber=function(){return this.scenes.toArray().length;};Animation.prototype.clone=function(){var animation=new Animation();animation.scenes=this.scenes;return animation;};function AnimationFrame(){this.jsjava_class="jsorg.eob.animation.AnimationFrame";};AnimationFrame.prototype.setStatus=function(status){this.status=status;};AnimationFrame.prototype.getStatus=function(){return this.status;};AnimationFrame.prototype.setModel=function(model){this.model=model;};AnimationFrame.prototype.getModel=function(){return this.model;};function AnimationFrameModel(){this.jsjava_class="jsorg.eob.animation.AnimationFrameModel";this.id=null;this.name=null;this.title=null;this.type=null;};AnimationFrameModel.prototype.setId=function(id){this.id=id;};AnimationFrameModel.prototype.getId=function(){return this.id;};AnimationFrameModel.prototype.setName=function(name){this.name=name;};AnimationFrameModel.prototype.getName=function(){return this.name;};AnimationFrameModel.prototype.setTitle=function(title){this.title=title;};AnimationFrameModel.prototype.getTitle=function(){return this.title;};AnimationFrameModel.prototype.setType=function(type){this.type=type;};AnimationFrameModel.prototype.getType=function(){return this.type;};function AnimationScene(){this.jsjava_class="jsorg.eob.animation.AnimationScene";this.frames=new ArrayList();};AnimationScene.prototype.setSequence=function(sequence){this.sequence=sequence;};AnimationScene.prototype.getSequence=function(){return this.sequence;};AnimationScene.prototype.addFrame=function(frame){this.frames.add(frame);};AnimationScene.prototype.getFrames=function(){return this.frames.toArray();};function AnimationStudio(){this.jsjava_class="jsorg.eob.animation.AnimationStudio";this.animation=null;this.timer=null;this.sceneNumber=0;this.maxSceneNumber=0;this.instanceName=null;};AnimationStudio.prototype.setInstanceName=function(instanceName){this.instanceName=instanceName;};AnimationStudio.prototype.loadFromXml=function(aXml){var parser=new XmlBrowserParser();parser.loadXml(aXml);var xmldom=parser.toDocument();var rootElem=xmldom.documentElement;var sceneElems=rootElem.getElementsByTagName("graph-scene");var scenesSize=sceneElems.length;this.maxSceneNumber=scenesSize;var animation=new Animation();for(var i=0;i<scenesSize;i++){var sceneElem=sceneElems[i];var scene=new AnimationScene();var sceneSequenceElem=sceneElem.getElementsByTagName("graph-scene-sequence")[0];var sceneSequence=sceneSequenceElem.firstChild.nodeValue;scene.setSequence(sceneSequence);var frameElems=sceneElem.getElementsByTagName("graph-frame");var framesSize=frameElems.length;for(var j=0;j<framesSize;j++){var frameElem=frameElems[j];var frame=new AnimationFrame();var statusElem=frameElem.getElementsByTagName("graph-frame-status")[0];var status=statusElem.firstChild.nodeValue;frame.setStatus(status);var model=new AnimationFrameModel();var modelElem=frameElem.getElementsByTagName("graph-object")[0];var typeElem=modelElem.getElementsByTagName("graph-type")[0];var type=typeElem.firstChild.nodeValue;var metaElem=modelElem.getElementsByTagName("graph-meta-info")[0];var id=metaElem.getElementsByTagName("graph-object-id")[0].firstChild.nodeValue;var name=metaElem.getElementsByTagName("graph-object-name")[0].firstChild.nodeValue;var title=metaElem.getElementsByTagName("graph-object-label")[0].firstChild.nodeValue;model.setId(id);model.setName(name);model.setTitle(title);model.setType(type);frame.setModel(model);scene.addFrame(frame);}animation.addScene(scene);}this.animation=animation;};AnimationStudio.prototype.load=function(animation){this.animation=animation;};AnimationStudio.prototype.setInterval=function(interval){this.interval=interval;};AnimationStudio.prototype.getInterval=function(){return this.interval;};AnimationStudio.prototype.setAction=function(action){this.action=action;};AnimationStudio.prototype.getAction=function(){return this.action;};AnimationStudio.prototype.setStartAction=function(action){this.startAction=action;};AnimationStudio.prototype.getStartAction=function(){return this.startAction;};AnimationStudio.prototype.setRender=function(render){this.render=render;};AnimationStudio.prototype.getRender=function(){return this.render;};AnimationStudio.prototype.setEndAction=function(action){this.endAction=action;};AnimationStudio.prototype.getEndAction=function(){return this.endAction;};AnimationStudio.prototype.play=function(){var action=this.getAction();var startAction=this.getStartAction();if(typeof(startAction)=="function"){startAction();}else{eval("window."+startAction+"()");}if(action){if(typeof(action)=="function"){this.timer=setInterval(action(),this.getInterval());}else{this.timer=setInterval(action+"()",this.getInterval());}}else{this.timer=setInterval("jsjava_play_animation('"+this.instanceName+"')",this.getInterval());}};AnimationStudio.prototype.suspend=function(){clearInterval(this.timer);};AnimationStudio.prototype.restore=function(){this.play();};AnimationStudio.prototype.stop=function(){var endAction=studio.getEndAction();if(endAction){if(typeof(endAction)=="function"){endAction();}else{eval("window."+endAction+"()");}}if(this.timer&&this.timer!=null){clearInterval(this.timer);}this.sceneNumber=0;};function jsjava_play_animation(studioInstanceName){var studio=eval("window."+studioInstanceName);studio.sceneNumber++;if(studio.sceneNumber>=studio.maxSceneNumber-1){studio.stop();return;}var render=studio.getRender();var currentScene=studio.animation.getScene(studio.sceneNumber);var frames=currentScene.getFrames();for(var i=0;i<frames.length;i++){var frame=frames[i];var status=frame.getStatus();var model=frame.getModel();var type=model.getType();var id=model.getId();var title=model.getTitle();eval("window."+render+"('"+id+"','"+type+"','"+status+"','"+title+"')");}};